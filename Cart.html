
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Courgette&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Viga&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../Codes/style.css">

  <style>
    .cart-wrapper {
      max-width: 900px;
      margin: 100px auto 40px auto;
      padding: 20px;
      background-color: #ececec;
      border-radius: 0;
    }

    .cart-item {
      display: flex;
      align-items: center;
      background-color: #ececec;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 0;
    }

    .cart-item img {
      width: 120px;
      height: auto;
      object-fit: cover;
      margin-right: 20px;
      border-radius: 5px;
    }

    /* Allows t h element to take up as much space as possible */
    .cart-details {
      flex: 1;
    }

    .cart-details h3 {
      margin: 0 0 5px;
      font-size: 18px;
      font-weight: bold;
      font-family: 'Poppins', sans-serif;
    }

    .cart-details p {
      margin: 4px 0;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
    }

    .quantity-wrapper {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 5px;
    }

    .quantity-input {
      width: 50px;
      padding: 4px;
      text-align: center;
      font-weight: bold;
      font-size: 14px;
    }

    .cart-totals {
      font-family: 'Poppins', sans-serif;
      padding: 10px 0 0 5px;
    }

    .cart-totals p {
      font-size: 14px;
      margin: 4px 0;
    }

    .cart-totals h3 {
      font-size: 20px;
      font-weight: bold;
      margin-top: 10px;
    }

    .checkout-btn {
      margin-top: 20px;
      padding: 10px 25px;
      background-color: #10b658;
      color: white;
      border: none;
      border-radius: 6px;
      font-family: 'Viga', sans-serif;
      font-size: 15px;
      letter-spacing: 0.03em;
      cursor: pointer;
    }

    .checkout-btn:hover {
      background-color: #299761;
    }

    .remove-icon {
      color: #d9534f;
      font-size: 18px;
      cursor: pointer;
      padding-left: 10px;
      transition: color 0.3s ease;
    }

    .remove-icon:hover {
      color: #a94442;
    }

  </style>
</head>
<body>
  <header style="margin-top: -100px;">
    <img src="../Assets/Print-Xbanner.png" alt="Logo" style="height: 60px;margin-left: 15%;" />
    <ul>
      <li><a href="../Codes/Print-X.html">Products</a></li>
      <li><a href="../Codes/AboutUs.html">About Us</a></li>
      <li class="cart-dropdown">
        <a href="../Codes/Cart.html">
          <img src="https://cdn-icons-png.flaticon.com/512/107/107831.png" class="cart-icon" />
        </a>
        <ul class="dropdown-menu">
          <li><a href="../Codes/ViewInvoice.html">View Invoice</a></li>
          <li><a href="../Codes/Cart.html">View Cart</a></li>
          <li><a href="../Codes/Checkout.html">Checkout</a></li>
        </ul>
      </li>
      <li><a id="loginstatus" href="../Codes/Login.html"><button class="button1">Login</button></a></li>
    </ul>
  </header>

  <div class="cart-wrapper" id="cart-container"></div>

  <script>
	// This object links each product to its image
	const productImages = {
		"Business Cards": "https://i.etsystatic.com/11215820/r/il/c2bb10/1005055933/il_570xN.1005055933_cbkl.jpg",
		"Programmes": "https://i.etsystatic.com/12294963/r/il/821291/1694644026/il_570xN.1694644026_ro4i.jpg",
		"Flyers/Posters": "https://eadn-wc02-2089561.nxedge.io/cdn/media/catalog/product/cache/de88093357d11832c3cd2895a4184815/c/o/color-copies-v1_2.png",
		"Labels & Stickers": "https://splus-assets.pnimedia.com/dynamic/en-US/CustomLabelsStickers_ComputerLabels/thumb?v=fd0b072c3e613aa1",
		"Tickets": "https://www.gleeprinting.ph/content/images/thumbs/0002090_tickets.png",
		"Receipt Books": "https://m.media-amazon.com/images/I/61fDuHFkxxL._AC_UF350,350_QL80_.jpg",
		"Custom T-Shirts": "https://embroly.com/cdn/shop/files/Custom-Embroidery-T-Shirts_1200x.jpg?v=1744604390",
		"Buttons": "https://disciplepress.com/wp-content/uploads/2023/07/MB-1008.jpg",
		"Vinyls": "https://media.karousell.com/media/photos/products/2023/10/12/vinyl_decal_sticker_1697094024_7a2a1d78_progressive.jpg",
		"Banners": "https://dqj17tese79do.cloudfront.net/acmesigns/images/product/Custom-PVC-Banner-Printing-Services-in-Orlando-Florida.jpg",
		"Stamps & Seals": "https://5.imimg.com/data5/SELLER/Default/2021/2/ID/OI/SI/5898726/a-v-trading-co-dwarka-delhi-rubber-stamp-manufacturers-kfaxh-500x500.jpg",
		"Signs": "https://www.nextdaysignscols.com/wp-content/gallery/yard-signs/JM-Construction.JPG"
	};

	// This object stores the unit price and minimum quantity for each product
	const productPrices = {
		"Business Cards": { price: 2200, minimum: 50 },
		"Programmes": { price: 7500, minimum: 50 },
		"Flyers/Posters": { price: 1500, minimum: 10 },
		"Labels & Stickers": { price: 2100, minimum: 100 },
		"Tickets": { price: 4500, minimum: 100 },
		"Receipt Books": { price: 16000, minimum: 2 },
		"Custom T-Shirts": { price: 2600, minimum: 3 },
		"Buttons": { price: 1000, minimum: 10 },
		"Vinyls": { price: 2800, minimum: 1 },
		"Banners": { price: 3000, minimum: 1 },
		"Stamps & Seals": { price: 4000, minimum: 1 },
		"Signs": { price: 6100, minimum: 1 }
	};

	// Gets where the cart items will show
	const container = document.getElementById("cart-container");

	// Shows the cart items in local storage
	function renderCart() {
		const cart = JSON.parse(localStorage.getItem("cartItems")) || [];

		// Shows a messag eif the cart is empty
		if (cart.length === 0) {
			container.innerHTML = "<p>Your cart is empty.</p>";
			return;
		}

        //Making the html for cart container blank until it loops through and updates
		let html = "";
        //Starting subtotal as 0
		let subtotal = 0;

		// Looping through all cart items and building their display
		for (let i = 0; i < cart.length; i++) {
			const item = cart[i];
			const price = productPrices[item.productName].price;
			const minimum = productPrices[item.productName].minimum;
			const unitPrice = price / minimum;
			const itemSubtotal = item.quantity * unitPrice;

			subtotal += itemSubtotal;

			html += `
				<div class="cart-item">
					<img src="${productImages[item.productName]}" alt="${item.productName}">
					<div class="cart-details">
						<h3>${item.productName}</h3>
						<p><i>Size:</i> ${item.size}</p>
						<p><i>Design:</i> ${item.designOption}</p>
						<div class="quantity-wrapper">
							<label>Qty:</label>

                            <!-- Makes sure quanity is only numbers and it cant go below the minimum amount that cna be made for said product-->
                            <!-- Automatically updates the cart when the quantity is changed -->
                            
							<input type="number" class="quantity-input" min="${minimum}" value="${item.quantity}" onchange="updateInputQuantity(${i}, this.value)">
							<i class="fas fa-trash remove-icon" onclick="removeItem(${i})"></i>
						</div>
						<p><i>Sub-total:</i> $${itemSubtotal.toFixed(2)}</p>
					</div>
				</div>
			`;
		}

		// Calculate tax and total
		const tax = subtotal * 0.15;
		const total = subtotal + tax;

		// Adding total to the html
		html += `
			<div class="cart-totals">
				<p>Subtotal: $${subtotal.toFixed(2)}</p>
				<p>Tax (15%): $${tax.toFixed(2)}</p>
				<h3>Total: <b>$${total.toFixed(2)}</b></h3>
				<button class="checkout-btn" onclick="window.location.href='../Codes/Checkout.html'">Checkout</button>
			</div>
		`;

		// Displaying evrything in cart container
		container.innerHTML = html;
	}

	// This updates the quantity when changed in the input box
	function updateInputQuantity(index, newValue) {
		const cart = JSON.parse(localStorage.getItem("cartItems")) || [];
		const item = cart[index];
		const min = productPrices[item.productName].minimum;
		const qty = parseInt(newValue);

		// Only update if quantity is a number and not less than minimum
		if (!isNaN(qty) && qty >= min) {
			item.quantity = qty;
			localStorage.setItem("cartItems", JSON.stringify(cart));
			renderCart(); // refresh the cart display
		}
	}

	// This removes an item from the cart
	function removeItem(index) {
		const cart = JSON.parse(localStorage.getItem("cartItems")) || [];
		cart.splice(index, 1); // remove 1 item at that position
		localStorage.setItem("cartItems", JSON.stringify(cart));
		renderCart(); // refresh
	}

	// Call the function to show the cart when the page loads
	renderCart();

</script>

<!--  Script for login status -->
<script>
  
    const loginStatusBtn = document.getElementById("loginstatus"); // Login/Logout button
    const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser")); // Get logged in user
    const cartContainer = document.getElementById("cart-container");
    if (!loggedInUser) {
      // Shows that the user needs to login to view their cart
      cartContainer.innerHTML = "<p>Login to view cart.</p>";
  
      loginStatusBtn.textContent = "Login";
      loginStatusBtn.href = "../Codes/Login.html?redirect=cart"; // Send user to login
      loginStatusBtn.classList.add("button1");
  
    } else {
      // Allows logged in user to logout
      loginStatusBtn.textContent = "Log Out";
      loginStatusBtn.href = "#";
      loginStatusBtn.classList.add("button1");
  
      loginStatusBtn.addEventListener("click", function (e) {
        e.preventDefault();
        localStorage.removeItem("loggedInUser"); // Clear user
        localStorage.removeItem("cartItems");    // Clear cart too
        location.reload(); // Refresh cart page
      });
    }
  </script>
  
</body>
</html>
  
